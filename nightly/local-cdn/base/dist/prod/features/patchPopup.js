"use strict";import g from"../getSharedResource.js";import h from"./insertOpenUI5PopupStyles.js";const p=g("AllOpenedPopupsRegistry",{openedRegistry:[]}),a=e=>{p.openedRegistry.push(e)},u=e=>{const o=p.openedRegistry.findIndex(t=>t.instance===e);o>-1&&p.openedRegistry.splice(o,1)},O=()=>p.openedRegistry[p.openedRegistry.length-1].instance,l=e=>{for(let o=p.openedRegistry.length-1;o>=0;o--){const t=p.openedRegistry[o];if(t.type==="WebComponent")return!0;if(t.instance===e)break}return!1},P=e=>{e.setAttribute("popover","manual"),e.showPopover()},f=e=>{e.hasAttribute("popover")&&(e.hidePopover(),e.removeAttribute("popover"))},y=(e=document)=>e.querySelector(":popover-open")?!0:Array.from(e.querySelectorAll("*")).some(o=>{const t=o.shadowRoot;return t&&y(t)}),d=e=>{const o=e.prototype.onsapescape;e.prototype.onsapescape=function(...n){l(this.oPopup)||o.apply(this,n)}},m=e=>{const o=e.prototype.open;e.prototype.open=function(...n){o.apply(this,n);const s=y();if(["OPENING","OPEN"].includes(this.getOpenState())&&s){const r=this.getContent();if(r){const i=r instanceof HTMLElement?r:r?.getDomRef();i&&P(i)}}a({type:"OpenUI5",instance:this})}},I=e=>{const o=e.prototype._closed;e.prototype._closed=function(...n){const s=this.getContent(),c=s instanceof HTMLElement?s:s?.getDomRef();o.apply(this,n),c&&f(c),u(this)}},v=e=>{const o=e.prototype.onFocusEvent;e.prototype.onFocusEvent=function(...n){l(this)||o.apply(this,n)}},C=()=>{const e=new CSSStyleSheet;e.replaceSync(".sapMPopup-CTX:popover-open { inset: unset; }"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]},S=(e,o,t)=>{h(),m(e),I(e),C(),v(e),d(o),d(t)};export{S as patchPopup,a as addOpenedPopup,u as removeOpenedPopup,O as getTopmostPopup};
//# sourceMappingURL=patchPopup.js.map
